var = NULL
){
for(i in 1:length(data)){
mean[i]<-mean(data[,i])
sd[i]<-sd(data[,i])
median[i]<-median(data[,i])
var[i]<-var(data[,i])
}
result<- data.frame("mean" = mean, "sd" = sd, "median" = median,"var" = var)
row.names(result)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
result
}
#SE CREAN LOS HISTOGRAMAS PARA DEMÓCRATAS Y REPUBLICANOS
plot.hist<-function(
data,
x,
y,
tittle,
xlab,
ylab
){
ggplot(data, aes(x = x, y = y))+
geom_bar(
aes(fill =x ), stat = "identity", color = "black",
position = position_dodge(0.9)
)+ labs(fill = "Votos")+
ggtitle(tittle)+
labs(x=xlab,y=ylab)
}
#DATA: DATOS ORIGINALES DE LA BASE DE DATOS, CON LOS POLÍTICOS Y SUS VOTOS
data <- read.csv("house-votes-84.data", header = TRUE, sep = ",",quote = "\"",fill=T)
colnames(data) <- c("classname", "handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
democrat<-filter(data, data$classname == "democrat")
republican<-filter(data, data$classname == "republican")
data1<-data.filter(data,c("NV","n","y"))
data2 <- data.filter(democrat,c("DemocratNV","DemocratN","DemocratY"))
data3 <- data.filter(republican,c("RepublicanNV","RepublicanN","RepublicanY"))
#FINAL TIENE EN SUS COLUMNAS LOS NOMBRES DE LAS VOTACIONES Y EN SUS FILAS LOS TIPOS DE VOTOS (TAMBIÉN SEPARADOS EN
#DEMOCRATAS Y REPUBLICANOS)
final <- c(data1,data2,data3)
final<-do.call(rbind.data.frame, final)
colnames(final) <- c("handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
row.names(final)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
##############
a<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
b<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
c<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
d<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
e<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
f<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
g<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
h<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
i<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
j<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
k<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
l<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
m<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
n<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
o<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
p<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
lay <- rbind(c(1,2,3,4),
c(5,6,7,8),
c(9,10,11,12),
c(13,14,15,16))
grid.arrange(a, b, ncol = 1)
grid.arrange(a, b,c ,ncol = 1)
grid.arrange(a, b,c,d ,ncol = 1)
grid.arrange(a, b,c,d ,ncol = 2)
grid.arrange(a, b,c,d,e,f ,ncol = 2)
grid.arrange(a, b,c,d,e,f,g,h ,ncol = 3)
grid.arrange(a, b,c,d,e,f,g,h ,ncol = 4)
grid.arrange(a, b,c,d,e,f,g,h,i,j,k ,ncol = 4)
grid.arrange(a, b,c,d,e,f,g,h,i,j,k,l,m,n,o,p ,ncol = 4)
x<-c(a, b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
grid.arrange(x ,ncol = 4)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
#setwd("/Users/cata/Desktop/Lab-analisis-de-datos/Lab1")
#DATA.FILTER obtiene la tabla de frecuencia de los votos totales, de democratas y republicanos par cada
#votación
data.filter<-function(
data,
col.names
){
data2 <- lapply(X=data,FUN = function(m) df <- summary(m))
data2[1]<-NULL
data2<-do.call(rbind.data.frame, data2)
colnames(data2)<-col.names
data2
}
#Cálculo de las medidas como varianza, desviación, media y mediana
#Salida: Una tabla en donde las columnas son los casos ( NV, Y , N, ETC) y las filas las medidas
statistical.measures<-function(
data,
mean =NULL,
sd = NULL,
median = NULL,
var = NULL
){
for(i in 1:length(data)){
mean[i]<-mean(data[,i])
sd[i]<-sd(data[,i])
median[i]<-median(data[,i])
var[i]<-var(data[,i])
}
result<- data.frame("mean" = mean, "sd" = sd, "median" = median,"var" = var)
row.names(result)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
result
}
#SE CREAN LOS HISTOGRAMAS PARA DEMÓCRATAS Y REPUBLICANOS
plot.hist<-function(
data,
x,
y,
tittle,
xlab,
ylab
){
ggplot(data, aes(x = x, y = y))+
geom_bar(
aes(fill =x ), stat = "identity", color = "black",
position = position_dodge(0.9)
)+ labs(fill = "Votos")+
ggtitle(tittle)+
labs(x=xlab,y=ylab)
}
#DATA: DATOS ORIGINALES DE LA BASE DE DATOS, CON LOS POLÍTICOS Y SUS VOTOS
data <- read.csv("house-votes-84.data", header = TRUE, sep = ",",quote = "\"",fill=T)
colnames(data) <- c("classname", "handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
democrat<-filter(data, data$classname == "democrat")
republican<-filter(data, data$classname == "republican")
data1<-data.filter(data,c("NV","n","y"))
data2 <- data.filter(democrat,c("DemocratNV","DemocratN","DemocratY"))
data3 <- data.filter(republican,c("RepublicanNV","RepublicanN","RepublicanY"))
#FINAL TIENE EN SUS COLUMNAS LOS NOMBRES DE LAS VOTACIONES Y EN SUS FILAS LOS TIPOS DE VOTOS (TAMBIÉN SEPARADOS EN
#DEMOCRATAS Y REPUBLICANOS)
final <- c(data1,data2,data3)
final<-do.call(rbind.data.frame, final)
colnames(final) <- c("handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
row.names(final)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
##############
a<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
b<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
c<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
d<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
e<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
f<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
g<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
h<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
i<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
j<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
k<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
l<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
m<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
n<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
o<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
p<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
lay <- rbind(c(1,2,3,4),
c(5,6,7,8),
c(9,10,11,12),
c(13,14,15,16))
grid.arrange(a, b,c,d,e,f,g,h,i,j,k,l,m,n,o,p ,ncol = 4)
x<-c(a, b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
grid.arrange(x ,ncol = 4)
x<-c(a, b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
grid.arrange(x ,ncol = 4)
a<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
democrat.range<-final[4:6,]
xlab = "Tipo de voto"
ylab = "Cantidad de votos"
a<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
a
row.names(final)<-c("No vota","No","Sí","No vota","No","Sí","No vota","No","Sí")
row.names(final)<-c("No vota","No","Sí","D. No vota","D. No","D. Sí","R. No vota","R. No","R. Sí")
democrat.range<-final[4:6,]
xlab = "Tipo de voto"
ylab = "Cantidad de votos"
a<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
b<-plot.hist(final[4:6,],rownames(final[4:6,]),final[4:6,]$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)","Tipo de voto","Cantidad de votos")
A
a
final
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
#setwd("/Users/cata/Desktop/Lab-analisis-de-datos/Lab1")
#DATA.FILTER obtiene la tabla de frecuencia de los votos totales, de democratas y republicanos par cada
#votación
data.filter<-function(
data,
col.names
){
data2 <- lapply(X=data,FUN = function(m) df <- summary(m))
data2[1]<-NULL
data2<-do.call(rbind.data.frame, data2)
colnames(data2)<-col.names
data2
}
#Cálculo de las medidas como varianza, desviación, media y mediana
#Salida: Una tabla en donde las columnas son los casos ( NV, Y , N, ETC) y las filas las medidas
statistical.measures<-function(
data,
mean =NULL,
sd = NULL,
median = NULL,
var = NULL
){
for(i in 1:length(data)){
mean[i]<-mean(data[,i])
sd[i]<-sd(data[,i])
median[i]<-median(data[,i])
var[i]<-var(data[,i])
}
result<- data.frame("mean" = mean, "sd" = sd, "median" = median,"var" = var)
row.names(result)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
result
}
#SE CREAN LOS HISTOGRAMAS PARA DEMÓCRATAS Y REPUBLICANOS
plot.hist<-function(
data,
x,
y,
tittle,
xlab,
ylab
){
ggplot(data, aes(x = x, y = y))+
geom_bar(
aes(fill =x ), stat = "identity", color = "black",
position = position_dodge(0.9)
)+ labs(fill = "Votos")+
ggtitle(tittle)+
labs(x=xlab,y=ylab)
}
#DATA: DATOS ORIGINALES DE LA BASE DE DATOS, CON LOS POLÍTICOS Y SUS VOTOS
data <- read.csv("house-votes-84.data", header = TRUE, sep = ",",quote = "\"",fill=T)
colnames(data) <- c("classname", "handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
democrat<-filter(data, data$classname == "democrat")
republican<-filter(data, data$classname == "republican")
data1<-data.filter(data,c("NV","n","y"))
data2 <- data.filter(democrat,c("DemocratNV","DemocratN","DemocratY"))
data3 <- data.filter(republican,c("RepublicanNV","RepublicanN","RepublicanY"))
#FINAL TIENE EN SUS COLUMNAS LOS NOMBRES DE LAS VOTACIONES Y EN SUS FILAS LOS TIPOS DE VOTOS (TAMBIÉN SEPARADOS EN
#DEMOCRATAS Y REPUBLICANOS)
final <- c(data1,data2,data3)
final<-do.call(rbind.data.frame, final)
colnames(final) <- c("handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
row.names(final)<-c("No vota","No","Sí","D. No vota","D. No","D. Sí","R. No vota","R. No","R. Sí")
###############################################GRÁFICOS######################################################################
democrat.range<-final[4:6,]
xlab = "Tipo de voto"
ylab = "Cantidad de votos"
d1<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
d2<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
d3<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
d4<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
d5<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
d6<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
d7<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
d8<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
d9<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
d10<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
d11<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
d12<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
d13<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
d14<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
d15<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
d16<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16 ,ncol = 4)
colnames(final)
d1<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
d2<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
d3<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
d4<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
d5<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
d6<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
d7<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
d8<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
d9<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
d10<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
d11<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
d12<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
d13<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
d14<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
d15<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
d16<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
d17<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16 ,ncol = 4)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
#setwd("/Users/cata/Desktop/Lab-analisis-de-datos/Lab1")
#DATA.FILTER obtiene la tabla de frecuencia de los votos totales, de democratas y republicanos par cada
#votación
data.filter<-function(
data,
col.names
){
data2 <- lapply(X=data,FUN = function(m) df <- summary(m))
data2[1]<-NULL
data2<-do.call(rbind.data.frame, data2)
colnames(data2)<-col.names
data2
}
#Cálculo de las medidas como varianza, desviación, media y mediana
#Salida: Una tabla en donde las columnas son los casos ( NV, Y , N, ETC) y las filas las medidas
statistical.measures<-function(
data,
mean =NULL,
sd = NULL,
median = NULL,
var = NULL
){
for(i in 1:length(data)){
mean[i]<-mean(data[,i])
sd[i]<-sd(data[,i])
median[i]<-median(data[,i])
var[i]<-var(data[,i])
}
result<- data.frame("mean" = mean, "sd" = sd, "median" = median,"var" = var)
row.names(result)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
result
}
#SE CREAN LOS HISTOGRAMAS PARA DEMÓCRATAS Y REPUBLICANOS
plot.hist<-function(
data,
x,
y,
tittle,
xlab,
ylab
){
ggplot(data, aes(x = x, y = y))+
geom_bar(
aes(fill =x ), stat = "identity", color = "black",
position = position_dodge(0.9)
)+ labs(fill = "Votos")+
ggtitle(tittle)+
labs(x=xlab,y=ylab)
}
#DATA: DATOS ORIGINALES DE LA BASE DE DATOS, CON LOS POLÍTICOS Y SUS VOTOS
data <- read.csv("house-votes-84.data", header = TRUE, sep = ",",quote = "\"",fill=T)
colnames(data) <- c("classname", "handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
democrat<-filter(data, data$classname == "democrat")
republican<-filter(data, data$classname == "republican")
data1<-data.filter(data,c("NV","n","y"))
data2 <- data.filter(democrat,c("DemocratNV","DemocratN","DemocratY"))
data3 <- data.filter(republican,c("RepublicanNV","RepublicanN","RepublicanY"))
#FINAL TIENE EN SUS COLUMNAS LOS NOMBRES DE LAS VOTACIONES Y EN SUS FILAS LOS TIPOS DE VOTOS (TAMBIÉN SEPARADOS EN
#DEMOCRATAS Y REPUBLICANOS)
final <- c(data1,data2,data3)
final<-do.call(rbind.data.frame, final)
colnames(final) <- c("handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
row.names(final)<-c("No vota","No","Sí","D. No vota","D. No","D. Sí","R. No vota","R. No","R. Sí")
###############################################GRÁFICOS######################################################################
d.range<-final[4:6,]
r<-final[7:9,]
xlab = "Tipo de voto"
ylab = "Cantidad de votos"
d1<-plot.hist(d.range,rownames(d.range),d.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
d2<-plot.hist(d.range,rownames(d.range),d.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
d3<-plot.hist(d.range,rownames(d.range),d.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
d4<-plot.hist(d.range,rownames(d.range),d.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
d5<-plot.hist(d.range,rownames(d.range),d.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
d6<-plot.hist(d.range,rownames(d.range),d.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
d7<-plot.hist(d.range,rownames(d.range),d.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
d8<-plot.hist(d.range,rownames(d.range),d.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
d9<-plot.hist(d.range,rownames(d.range),d.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
d10<-plot.hist(d.range,rownames(d.range),d.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
d11<-plot.hist(d.range,rownames(d.range),d.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
d12<-plot.hist(d.range,rownames(d.range),d.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
d13<-plot.hist(d.range,rownames(d.range),d.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
d14<-plot.hist(d.range,rownames(d.range),d.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
d15<-plot.hist(d.range,rownames(d.range),d.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
d16<-plot.hist(d.range,rownames(d.range),d.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
d17<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16 ,ncol = 4)
r1<-plot.hist(r.range,rownames(r.range),r.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
r2<-plot.hist(r.range,rownames(r.range),r.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
r3<-plot.hist(r.range,rownames(r.range),r.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
r4<-plot.hist(r.range,rownames(r.range),r.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
r5<-plot.hist(r.range,rownames(r.range),r.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
r6<-plot.hist(r.range,rownames(r.range),r.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
r7<-plot.hist(r.range,rownames(r.range),r.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
r8<-plot.hist(r.range,rownames(r.range),r.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
r9<-plot.hist(r.range,rownames(r.range),r.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
r10<-plot.hist(r.range,rownames(r.range),r.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
r11<-plot.hist(r.range,rownames(r.range),r.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
r12<-plot.hist(r.range,rownames(r.range),r.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
r13<-plot.hist(r.range,rownames(r.range),r.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
r14<-plot.hist(r.range,rownames(r.range),r.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
r15<-plot.hist(r.range,rownames(r.range),r.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
r16<-plot.hist(r.range,rownames(r.range),r.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
r17<-plot.hist(r.range,rownames(r.range),r.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16 ,ncol = 4)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
#setwd("/Users/cata/Desktop/Lab-analisis-de-datos/Lab1")
#DATA.FILTER obtiene la tabla de frecuencia de los votos totales, de democratas y republicanos par cada
#votación
data.filter<-function(
data,
col.names
){
data2 <- lapply(X=data,FUN = function(m) df <- summary(m))
data2[1]<-NULL
data2<-do.call(rbind.data.frame, data2)
colnames(data2)<-col.names
data2
}
#Cálculo de las medidas como varianza, desviación, media y mediana
#Salida: Una tabla en donde las columnas son los casos ( NV, Y , N, ETC) y las filas las medidas
statistical.measures<-function(
data,
mean =NULL,
sd = NULL,
median = NULL,
var = NULL
){
for(i in 1:length(data)){
mean[i]<-mean(data[,i])
sd[i]<-sd(data[,i])
median[i]<-median(data[,i])
var[i]<-var(data[,i])
}
result<- data.frame("mean" = mean, "sd" = sd, "median" = median,"var" = var)
row.names(result)<-c("NV","n","y","DemocratNV","DemocratN","DemocratY","RepublicanNV","RepublicanN","RepublicY")
result
}
#SE CREAN LOS HISTOGRAMAS PARA DEMÓCRATAS Y REPUBLICANOS
plot.hist<-function(
data,
x,
y,
tittle,
xlab,
ylab
){
ggplot(data, aes(x = x, y = y))+
geom_bar(
aes(fill =x ), stat = "identity", color = "black",
position = position_dodge(0.9)
)+ labs(fill = "Votos")+
ggtitle(tittle)+
labs(x=xlab,y=ylab)
}
#DATA: DATOS ORIGINALES DE LA BASE DE DATOS, CON LOS POLÍTICOS Y SUS VOTOS
data <- read.csv("house-votes-84.data", header = TRUE, sep = ",",quote = "\"",fill=T)
colnames(data) <- c("classname", "handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
democrat<-filter(data, data$classname == "democrat")
republican<-filter(data, data$classname == "republican")
data1<-data.filter(data,c("NV","n","y"))
data2 <- data.filter(democrat,c("DemocratNV","DemocratN","DemocratY"))
data3 <- data.filter(republican,c("RepublicanNV","RepublicanN","RepublicanY"))
#FINAL TIENE EN SUS COLUMNAS LOS NOMBRES DE LAS VOTACIONES Y EN SUS FILAS LOS TIPOS DE VOTOS (TAMBIÉN SEPARADOS EN
#DEMOCRATAS Y REPUBLICANOS)
final <- c(data1,data2,data3)
final<-do.call(rbind.data.frame, final)
colnames(final) <- c("handicappedinfants","waterprojectcostsharing","adoptionofthebudgetresolution","physicianfeefreeze","elsalvadoraid","religiousgroupsinschools","antisatellitetestban","aidtonicaraguancontras","mxmissile","immigration","synfuelscorporationcutback","educationspending","superfundrighttosue","crime","dutyfreeexports","exportadministrationactsouthafrica")
row.names(final)<-c("No vota","No","Sí","D. No vota","D. No","D. Sí","R. No vota","R. No","R. Sí")
###############################################GRÁFICOS######################################################################
d.range<-final[4:6,]
r.range<-final[7:9,]
xlab = "Tipo de voto"
ylab = "Cantidad de votos"
d1<-plot.hist(d.range,rownames(d.range),d.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
d2<-plot.hist(d.range,rownames(d.range),d.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
d3<-plot.hist(d.range,rownames(d.range),d.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
d4<-plot.hist(d.range,rownames(d.range),d.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
d5<-plot.hist(d.range,rownames(d.range),d.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
d6<-plot.hist(d.range,rownames(d.range),d.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
d7<-plot.hist(d.range,rownames(d.range),d.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
d8<-plot.hist(d.range,rownames(d.range),d.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
d9<-plot.hist(d.range,rownames(d.range),d.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
d10<-plot.hist(d.range,rownames(d.range),d.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
d11<-plot.hist(d.range,rownames(d.range),d.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
d12<-plot.hist(d.range,rownames(d.range),d.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
d13<-plot.hist(d.range,rownames(d.range),d.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
d14<-plot.hist(d.range,rownames(d.range),d.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
d15<-plot.hist(d.range,rownames(d.range),d.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
d16<-plot.hist(d.range,rownames(d.range),d.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
d17<-plot.hist(democrat.range,rownames(democrat.range),democrat.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15,d16 ,ncol = 4)
r1<-plot.hist(r.range,rownames(r.range),r.range$"handicappedinfants", "Gráfico votos demócratas (handicappedinfants)",xlab,ylab)
r2<-plot.hist(r.range,rownames(r.range),r.range$"waterprojectcostsharing", "Gráfico votos demócratas (waterprojectcostsharing)",xlab,ylab)
r3<-plot.hist(r.range,rownames(r.range),r.range$"adoptionofthebudgetresolution", "Gráfico votos demócratas (adoptionofthebudgetresolution)",xlab,ylab)
r4<-plot.hist(r.range,rownames(r.range),r.range$"physicianfeefreeze", "Gráfico votos demócratas (physicianfeefreeze)",xlab,ylab)
r5<-plot.hist(r.range,rownames(r.range),r.range$"elsalvadoraid", "Gráfico votos demócratas (elsalvadoraid)",xlab,ylab)
r6<-plot.hist(r.range,rownames(r.range),r.range$"religiousgroupsinschools", "Gráfico votos demócratas (religiousgroupsinschools)",xlab,ylab)
r7<-plot.hist(r.range,rownames(r.range),r.range$"antisatellitetestban", "Gráfico votos demócratas (antisatellitetestban)",xlab,ylab)
r8<-plot.hist(r.range,rownames(r.range),r.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
r9<-plot.hist(r.range,rownames(r.range),r.range$"mxmissile", "Gráfico votos demócratas (mxmissile)",xlab,ylab)
r10<-plot.hist(r.range,rownames(r.range),r.range$"immigration", "Gráfico votos demócratas (immigration)",xlab,ylab)
r11<-plot.hist(r.range,rownames(r.range),r.range$"synfuelscorporationcutback", "Gráfico votos demócratas (synfuelscorporationcutback)",xlab,ylab)
r12<-plot.hist(r.range,rownames(r.range),r.range$"educationspending", "Gráfico votos demócratas (educationspending)",xlab,ylab)
r13<-plot.hist(r.range,rownames(r.range),r.range$"superfundrighttosue", "Gráfico votos demócratas (superfundrighttosue)",xlab,ylab)
r14<-plot.hist(r.range,rownames(r.range),r.range$"crime", "Gráfico votos demócratas (crime)",xlab,ylab)
r15<-plot.hist(r.range,rownames(r.range),r.range$"dutyfreeexports", "Gráfico votos demócratas (dutyfreeexports)",xlab,ylab)
r16<-plot.hist(r.range,rownames(r.range),r.range$"exportadministrationactsouthafrica", "Gráfico votos demócratas (exportadministrationactsouthafrica)",xlab,ylab)
r17<-plot.hist(r.range,rownames(r.range),r.range$"aidtonicaraguancontras", "Gráfico votos demócratas (aidtonicaraguancontras)",xlab,ylab)
grid.arrange(r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16 ,ncol = 4)
grid.arrange(r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16 ,ncol = 4)
